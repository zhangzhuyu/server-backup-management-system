<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper
    namespace="com.ly.cloud.backup.mapper.BusinessDomainMapper">

    <resultMap id="BaseResultMap"
        type="com.ly.cloud.backup.po.BusinessDomainPo">
        <id column="id" property="id" jdbcType="BIGINT" />
        <result column="code_name" property="codeName" jdbcType="VARCHAR" />
        <result column="code_key" property="codeKey" jdbcType="VARCHAR" />
        <result column="operation_time" property="operationTime" jdbcType="DATE" />
        <result column="operator_id" property="operatorId" jdbcType="VARCHAR" />
        <result column="remark" property="remark" jdbcType="VARCHAR" />
    </resultMap>

    <sql id="Base_Column_List">
		id,
		code_name,
		code_key,
		operator_id,
		operation_time,
		remark
    </sql>
    
    <resultMap id="BusinessDomainMap"
               type="com.ly.cloud.backup.vo.BusinessDomainVo" extends="BaseResultMap">
        
    </resultMap>

    <!-- 按主键查询 -->
    <select id="businessDomainCount" resultType="com.ly.cloud.backup.vo.SelectVo" parameterType="string">
        select app.business_domain as value,domain.code_name as label,count(*) as count
        from ly_rm_application app
        inner join ly_rm_business_domain domain on app.business_domain = domain.id
        <if test="searchParam != null and searchParam != ''">
           where app.chinese_name like concat('%', #{searchParam}, '%')
           or app.english_name like concat('%', #{searchParam}, '%')
        </if>
        group by app.business_domain
    </select>


</mapper>